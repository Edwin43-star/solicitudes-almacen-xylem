<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ app_name }} - Bandeja</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body class="page">
  <div class="topbar">
    <div class="brand-inline">
      <div class="logo">xylem</div>
      <div>
        <div class="title">{{ app_name }}</div>
        <div class="muted">Usuario: {{ user }}</div>
      </div>
    </div>
    <div class="topbar-right">
      <a class="btn secondary" href="{{ url_for('home') }}">Inicio</a>
      <a class="btn secondary" href="{{ url_for('solicitar') }}">Nueva</a>
      <a class="btn secondary" href="{{ url_for('logout') }}">Salir</a>
    </div>
  </div>

  <div class="container">
    <h1>Bandeja (Ãºltimas)</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="alerts">
        {% for cat,msg in messages %}
          <div class="alert {{cat}}">{{ msg }}</div>
        {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    {% if items %}
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>FECHA</th>
              <th>HORA</th>
              <th>CODIGO</th>
              <th>NOMBRE</th>
              <th>AREA</th>
              <th>CARGO</th>
              <th>TIPO</th>
              <th>DESCRIPCION</th>
              <th>CANTIDAD</th>
              <th>URGENCIA</th>
              <th>OBSERVACION</th>
              <th>ESTADO</th>
              <th>REGISTRADO</th>
            </tr>
          </thead>
          <tbody>
            {% for it in items %}
            <tr>
              <td>{{ it.get('FECHA','') }}</td>
              <td>{{ it.get('HORA','') }}</td>
              <td>{{ it.get('CODIGO','') }}</td>
              <td>{{ it.get('NOMBRE','') }}</td>
              <td>{{ it.get('AREA','') }}</td>
              <td>{{ it.get('CARGO','') }}</td>
              <td>{{ it.get('TIPO','') }}</td>
              <td>{{ it.get('DESCRIPCION','') }}</td>
              <td>{{ it.get('CANTIDAD','') }}</td>
              <td>{{ it.get('URGENCIA','') }}</td>
              <td>{{ it.get('OBSERVACION','') }}</td>
              <td><span class="badge">{{ it.get('ESTADO','') }}</span></td>
              <td>{{ it.get('REGISTRADO','') }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="card">
        No hay registros o no se pudo conectar al Sheet.
        <div class="muted">Revisa /health para ver el error exacto.</div>
      </div>
    {% endif %}
  </div>
</body>
</html>
